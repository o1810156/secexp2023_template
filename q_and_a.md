[README.md](README.md) > q_and_a.md

文責: 2023年度TA 修士2年 奥山

# よくある質問等

少し思想強めなTAが個人的に勝手にまとめたQ&Aページなので内容に偏りがあるかもしれません。

本ページには、実験自体を進めるにあたり必須な情報は載せていません。実験を進める上で各学生が自力でできていて欲しい内容が主となるページです。

随時追加していきます。

## 目次

- [どこにプログラムを書けばよいですか？](#どこにプログラムを書けばよいですか)
- [ライブラリはどうやって導入すればよいですか？](#ライブラリはどうやって導入すればよいですか)
- [CSVファイルの読み込みはどうすればよいですか？](#CSVファイルの読み込みはどうすればよいですか)
- [通信がうまくいきません](#通信がうまくいきません)
- [どのようなコードが望ましいですか？](#どのようなコードが望ましいですか)
- [ソースコード中にコメントを書いたほうがいいですか？](#ソースコード中にコメントを書いたほうがいいですか)
- [その他](#その他)

## どこにプログラムを書けばよいですか？

特にこだわりがなければ `lib.go` に記述し、 `kadai〇/main.go` から読み込むように書いてください。

## ライブラリはどうやって導入すればよいですか？

サードパーティ製のライブラリは `import` 文に書くだけでは使えません。`go get` コマンドでインストールする必要があります。

方法はライブラリによるので、そのライブラリの公式サイト等を参照し確認いたしましょう。

`gonum` の場合の例です。

- [gonum package - gonum.org/v1/gonum - Go Packages](https://pkg.go.dev/gonum.org/v1/gonum)

`...` は省略ではなく有効な文字列ですのでそのまま打ち込んでください。

```bash
$ go get -u gonum.org/v1/gonum/...
```

インストールが完了しましたら `import` 文に指定することで使用できるようになります。

```go
import (
	"gonum.org/v1/gonum/mat"
)
```


## CSVファイルの読み込みはどうすればよいですか？

後続で内容を使うことができれば基本的にはどのように読み込んでも構いませんが、特にこだわりがなく何か方針を求めるならば以下のようにしていただければと思います。

- ファイルパスは、 `go run` コマンドを打つディレクトリから見た相対パスにしましょう。
    - `go run kadai1/main.go` とするならばプログラム中で必要なパスの文字列は `omomi.txt` や `./omomi.txt` 等になります。
    - `cd kadai1` としてから `go run main.go` として実行する場合は、 `../omomi.txt` になるでしょう。
    - `go build` で実行ファイルを作成した場合は、実行ファイルをパスの起点にします。
    - 絶対パスは避けた方が無難です。
- `os.Open` 関数を使うことでファイルオブジェクトを取得し、 `encoding/csv` ライブラリを使用して読み込みます。
    - 参考: https://pkg.go.dev/encoding/csv
    - 参考: https://zenn.dev/syo_yamamoto/articles/1fb502ef862490
- とりあえず、読み込んだ値は `[][]float64` 型の配列に入れることを目指しましょう。
    - もちろん何かしらの行列計算ライブラリの行列型として読み込める方法があるならばその方法を用いていただいてかまいません。
- 文字列は `strconv.ParseFloat` という関数を用いることで `float64` 型の数値にパースできます。

方針を元に、言語仕様については[公式ドキュメント](https://go-tour-jp.appspot.com/welcome/1)等を参照して、後は各自実装していただきたいですが、「何を書けばいいか全くわからない」という方向けにファイル読み込みに関してだけはネタバレを載せておきます。

[ファイル読み込みのネタバレ](read_csv.md)

## 通信がうまくいきません

- 相方のコードと `SendTable` や `ReceiveTable` のタイミングが合っているか確認しましょう。
- 通信自体をテストするための古いコードが残っている可能性があります。`yobikou.Receive()` や `chugaku.Send([]byte("ping"))` が残ってしまっていないかを良く確認しましょう。
- ソースコードを書き直したもののビルドしなおすのを忘れた、等の細かいミスにより上手くいっていない可能性もあります。今一度最初から丁寧に確認してみてください。

## どのようなコードが望ましいですか？

あまり色々指定したくはありませんが、強いて言えば次の2点を守っているコードは美しいなぁと感じます。

- 適切に関数が分離されている
    - 同じ処理を関数にまとめず、全部展開しているようなコードは読みにくいです。実行速度ではなく読みやすさを優先してください。
    - 一度しか呼び出されない処理でも、適切に関数に分けられていたほうが読みやすいです。
        - なんでもかんでも関数化しろということではありません。
        - 例えば逆行列計算をそのまま書かれてもどこまでが該当する処理かわかりにくい、という意味です。
- インデントが深くない
    - 無駄な条件分岐が多いと読みにくく感じます。
        - [早期リターン](https://zenn.dev/media_engine/articles/early_return)等を駆使してネストを減らしてみてください。
        - どうしても深くなってしまう場合、関数が適切に分けられていない場合が多いです。

## ソースコード中にコメントを書いたほうがいいですか？

ソースコードの読みやすさによって実装に関する点数が上下する可能性はありますが、少なくとも本講義ではコメントの有無で加点減点することはありません。以降、講義は関係なく、あくまでも筆者個人の見解になります。

- ソースコードを読めば簡単に分かるような処理内容をコメントとして残すことは意味がないと考えています。
- コメントはソースコードからは全くあるいはすぐにはわからない内容についてのみ残すのが適切です。
    - 例えば「とても読みにくいプログラムになってしまったので不安なのでコメントをつけた」ならば意味があるコメントでしょう。

- 参考: [「コメントは書くな」 - Qiita](https://qiita.com/hiro-hori/items/1cf28a6ac75db077c8f3)

「書くな」とまでは言いませんし、コメント自体は適宜必要だとも思いますが、余計なコメントが多いとむしろわかりにくくなってしまうのは確かです。

以下に、例で解説します。

- 悪いコメント例
    - `fmt.Printf("Result: %v\n", res) // 結果を表示`
        - わざわざコメントを残すということは違う処理なのではと身構えてしまいます。
    - `// 変数aはbの逆行列`
        - `a` という情報量のない変数名を使わず、代わりに `b_inv` 等にしてください。
        - 変数に限らず関数や型、構造体等あらゆるものについて適切な名前を付けることで、読みやすいプログラムになります。
- 良いコメント例
    - `// 逆行列を求めるためにLU分解を使った`
        - LU分解を知らない人がプログラムを読んだ時の助けになります。
    - `// 実装は https://uec.example/lu_dec.html を参考にした`
        - 自分の助けにもなるので参考にしたURLを近くに残しましょう。

また、今回のPPDMプログラムに限った話としては、スライドに記載されたアルゴリズムの何番の処理をどこで行っているかを番号付きでコメントしていただけるとTAとしては助かります。

(ライブラリ制作ではなく、実行プログラムにおいての)コメント記載のコツは「自分にとって意味があるか/必要なコメントか」という基準です。「入れるべきかわからない」時は大体不要な時です。

## その他

このページに載っていない内容で不明点があれば、なるべく直接TAに聞いてください。

直接聞くのが難しい時は

csec_exp(西暦)@oslab.inf.uec.ac.jp

にメールで聞いてください。開講期間中時間があれば回答いたします。

(2023年度なら csec_exp2023@oslab.inf.uec.ac.jp )

もしメールで聞く場合はなるべくソースコードを記載または添付してください。文章だけで尋ねられても答えかねる場合が多いです。